<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Happy Birthday, Lee Wei Wen! 🎉</title>
  <meta name="description" content="A pink, balloon-and-hearts birthday page for Lee Wei Wen with countdown, floating wishes, confetti, and music." />
  <meta name="theme-color" content="#ffb3d9" />
  <style>
    :root{
      /* Palette */
      --bg1:#fff2f8; --bg2:#ffe6f3;
      --ink:#3a243c; --muted:#6c4a6e; --accent:#ff7fbf; --gold:#f6d36a; --white:#ffffff;
      --btn:#ff9fd1; --btnText:#3a243c; --btnHover:#ffa9d6; --shadow:0 12px 30px rgba(255, 120, 180, .25);
      /* Stream colors */
      --heart:#ff72c7; --heartSoft:#ffb6e6;
      --balloon:#e01d48; --balloonDark:#9e1734;
      --cake:#ffefc2; --cakeIcing:#ffd3e8; --candle:#ff7fbf;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans", Arial, sans-serif;
      background:
        radial-gradient(1200px 800px at 20% -10%, var(--bg1), transparent 70%),
        radial-gradient(1200px 800px at 80% 120%, var(--bg2), transparent 70%),
        linear-gradient(180deg, #fffafd 0%, #fff5fb 100%);
      overflow:hidden;
    }

    .wrap{ position:relative; height:100%; display:grid; place-items:center; text-align:center; padding:24px; }

    .card{
      position:relative; z-index:3;
      background:rgba(255,255,255,.75);
      backdrop-filter:saturate(1.4) blur(8px);
      border:1px solid #ffffffaa; border-radius:22px;
      padding:28px 22px; box-shadow:var(--shadow);
      max-width:820px; width:min(92vw, 820px);
    }

    h1{
      font-size:clamp(28px, 4.6vw, 52px);
      line-height:1.05; margin:0 0 8px; letter-spacing:.5px;
    }
    .name{
      font-weight:700;
      background:linear-gradient(90deg, var(--accent), #ff66b3);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      position:relative;
    }

    .type{
      font-size:clamp(16px, 2.6vw, 20px);
      color:var(--muted); min-height:1.2em; margin:.3rem 0 1.1rem;
      border-right:2px solid var(--accent); white-space:nowrap; overflow:hidden;
      animation: caret 1s steps(1) infinite;
    }
    @keyframes caret{50%{border-color:transparent}}

    .sparkles{
      position:absolute; inset:-8px; pointer-events:none;
      background:
        radial-gradient(6px 6px at 20% 30%, #ffd8f0 50%, transparent 52%),
        radial-gradient(7px 7px at 80% 20%, #ffe7f7 50%, transparent 52%),
        radial-gradient(5px 5px at 60% 80%, #ffe0f4 50%, transparent 52%),
        radial-gradient(6px 6px at 35% 70%, #ffd1ef 50%, transparent 52%),
        radial-gradient(5px 5px at 90% 65%, #fff0fa 50%, transparent 52%);
      opacity:.85; filter:drop-shadow(0 2px 4px #ffb6e088); animation: twinkle 4s ease-in-out infinite; border-radius:24px;
    }
    @keyframes twinkle{0%,100%{opacity:.55; transform:scale(1)}50%{opacity:1; transform:scale(1.02)}}

    .btns{ display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin-top:10px; }
    button{
      appearance:none; border:0; cursor:pointer; background:var(--btn); color:var(--btnText); font-weight:700;
      padding:12px 16px; border-radius:12px; box-shadow:var(--shadow);
      transition:transform .15s ease, background .2s ease, box-shadow .2s ease;
    }
    button:hover{ background:var(--btnHover); transform:translateY(-1px)}
    button:active{ transform:translateY(0) scale(.98)}
    button:focus-visible{ outline:3px solid #ffb6e0; outline-offset:2px }

    /* Countdown */
    .countdown{ display:grid; gap:10px; margin:14px auto 8px; }
    .cells{ display:grid; grid-template-columns:repeat(4, minmax(60px,1fr)); gap:10px; }
    .cell{
      background:#fff; border:1px solid #ffffffb3; border-radius:14px; padding:10px 8px;
      box-shadow:var(--shadow);
    }
    .num{ font-size:clamp(22px, 5vw, 36px); font-weight:800; line-height:1; }
    .lbl{ font-size:12px; letter-spacing:.
08em; color:#7b5a7d }

    .note{ margin-top:10px; font-size:12px; color:#7b5a7d; opacity:.85 }

    /* Wishes form */
    .wish-form{
      margin:14px auto 6px; display:flex; gap:8px; justify-content:center; flex-wrap:wrap;
    }
    .wish-form input{
      flex:1 1 340px; max-width:520px; padding:12px 14px; font-size:16px;
      border-radius:12px; border:1px solid #ffd0ea; outline:none;
      background:#fff; box-shadow:var(--shadow);
    }
    .wish-form input:focus{ border-color:#ff9fd1; }
    .wish-layer{ position:fixed; inset:0; pointer-events:none; z-index:2; overflow:hidden; }

    .wish-bubble{
      position:absolute; left:50%; bottom:-40px; transform:translateX(-50%);
      background:linear-gradient(180deg, #ffe5f4, #ffd3ee);
      border:1px solid #ffffffbb; border-radius:16px; padding:10px 12px;
      color:#5a2a57; font-weight:700; box-shadow:0 10px 18px rgba(255,120,180,.35);
      white-space:nowrap; filter:drop-shadow(0 2px 6px rgba(255, 120, 180, .35));
      animation: rise var(--dur, 10s) ease-in var(--delay, 0s) forwards;
    }
    @keyframes rise{
      0%{ transform:translate3d(var(--x, -50%), 0, 0) scale(.95); opacity:0 }
      10%{ opacity:1 }
      100%{ transform:translate3d(var(--x, -50%), -110vh, 0) scale(1.05); opacity:0 }
    }

    /* Stream layer (hearts, balloons, cakes) */
    .stream{ position:fixed; inset:0; pointer-events:none; z-index:0; overflow:hidden; }
    .sail{
      position:absolute; top:0; left:0; transform:translate3d(-12vw, 50vh, 0);
      animation: sail var(--dur) linear var(--delay) infinite;
      will-change: transform;
      filter:drop-shadow(0 8px 12px rgba(255, 120, 180,.25));
    }
    @keyframes sail{
      0%  { transform: translate3d(-12vw, var(--y), 0) rotate(-6deg) }
      25% { transform: translate3d(18vw,  calc(var(--y) + var(--bob)), 0) rotate(-2deg) }
      50% { transform: translate3d(50vw,  var(--y), 0) rotate(0deg) }
      75% { transform: translate3d(82vw,  calc(var(--y) - var(--bob)), 0) rotate(2deg) }
      100%{ transform: translate3d(112vw, var(--y), 0) rotate(6deg) }
    }

    /* Heart (pink love) */
    .heart{ width:44px; height:40px; position:relative; }
    .heart::before, .heart::after{
      content:""; position:absolute; width:22px; height:34px; background:radial-gradient(circle at 30% 18%, #fff8 0 20%, transparent 21%), linear-gradient(145deg, var(--heart), var(--heartSoft));
      border-radius:22px 22px 0 0;
    }
    .heart::before{ left:22px; transform:rotate(45deg); transform-origin:0 100%}
    .heart::after{ left:0; transform:rotate(-45deg); transform-origin:100% 100%}

    /* Red balloon (horizontal) */
    .redballoon{
      width:52px; height:66px; border-radius:50% 50% 46% 46%;
      background:
        radial-gradient(circle at 30% 28%, #ffffffcc 0 10%, transparent 12%),
        radial-gradient(circle at 40% 35%, #ffffff42 0 20%, transparent 22%),
        linear-gradient(145deg, var(--balloonDark), var(--balloon));
      position:relative;
    }
    .redballoon::after{ /* knot */
      content:""; position:absolute; left:50%; bottom:-7px; transform:translateX(-50%);
      width:10px; height:9px; background:var(--balloonDark); border-radius:2px 2px 6px 6px;
    }
    .string{
      position:absolute; left:50%; bottom:-110px; transform:translateX(-50%);
      width:2px; height:110px; background:linear-gradient(#00000022, #00000008); border-radius:2px;
      animation: sway calc(var(--dur) * .8) ease-in-out var(--delay) infinite;
    }
    @keyframes sway{0%,100%{ transform:translateX(-50%) rotate(-3deg)}50%{ transform:translateX(-50%) rotate(3deg)}}

    /* Cake (cute mini) */
    .cake{ width:56px; height:42px; position:relative; }
    .cake .tier{
      position:absolute; left:6px; right:6px; bottom:0; height:26px;
      background:linear-gradient(180deg, var(--cake), #ffdcae);
      border:1px solid #fff; border-radius:6px;
      box-shadow:inset 0 -6px 0 0 var(--cakeIcing);
    }
    .cake .candle{
      position:absolute; width:6px; height:18px; top:-18px; left:50%; transform:translateX(-50%);
background:var(--candle); border-radius:3px;
    }
    .cake .flame{
      position:absolute; width:8px; height:12px; top:-28px; left:50%; transform:translateX(-50%);
      background:radial-gradient(closest-side, #ffd36a, #ff9d00 60%, transparent 61%);
      border-radius:50%;
      animation: flicker .9s ease-in-out infinite;
      filter:drop-shadow(0 0 6px #ffc04d);
    }
    @keyframes flicker{50%{ transform:translateX(-50%) scaleY(.9)}}

    /* Confetti canvas */
    canvas#confetti{ position:fixed; inset:0; pointer-events:none; z-index:2}

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .sail, .string, .type, .sparkles, .wish-bubble{ animation:none !important }
      .wish-bubble{ position:static; display:block; margin:.2rem auto }
    }
  </style>
</head>
<body>
  <!-- Stream items (hearts, red balloons, cakes) -->
  <div class="stream" id="stream" aria-hidden="true"></div>
  <!-- Wishes float layer -->
  <div class="wish-layer" id="wishLayer" aria-hidden="true"></div>
  <!-- Confetti -->
  <canvas id="confetti" aria-hidden="true"></canvas>

  <div class="wrap">
    <section class="card" role="region" aria-label="Birthday greeting for Lee Wei Wen">
      <div class="sparkles" aria-hidden="true"></div>
      <h1>Happy Birthday, <span class="name">Lee Wei Wen</span>! 🎂</h1>
      <p class="type" id="typeLine" aria-live="polite"></p>
      <p style="margin:.2rem 0 1.0rem">
        Wishing you skies of pink hearts, balloons, and cake—plus a year full of joy and good surprises!
      </p>

      <!-- Countdown -->
      <div class="countdown" aria-label="Countdown to celebration">
        <div class="cells" id="cd">
          <div class="cell"><div class="num" id="d">0</div><div class="lbl">DAYS</div></div>
          <div class="cell"><div class="num" id="h">0</div><div class="lbl">HOURS</div></div>
          <div class="cell"><div class="num" id="m">0</div><div class="lbl">MINUTES</div></div>
          <div class="cell"><div class="num" id="s">0</div><div class="lbl">SECONDS</div></div>
        </div>
        <div class="note" id="cdNote"></div>
      </div>

      <div class="btns">
        <button id="partyBtn" type="button" aria-label="Launch confetti">🎊 Celebrate!</button>
        <button id="musicBtn" type="button" aria-label="Play or pause music">▶️ Play music</button>
        <button id="shareBtn" type="button" aria-label="Share this page">🤝 Share</button>
      </div>

      <!-- Wishes input -->
      <form class="wish-form" id="wishForm" autocomplete="off" aria-label="Add a floating birthday wish">
        <input id="wishInput" type="text" inputmode="text" maxlength="80" placeholder="Type a wish for Lee Wei Wen… (max 80 chars)"/>
        <button type="submit">🎈 Add Wish</button>
      </form>

      <p class="note">Tip: Put a <strong>birthday.mp3</strong> next to this file for music. Add <code>?t=2025-10-29T20:00</code> to set your own countdown time.</p>
    </section>
  </div>

  <!-- Optional music: place birthday.mp3 in the same folder -->
  <audio id="music" preload="auto" src="birthday.mp3" crossorigin="anonymous"></audio>

  <script>
  /* ========= Type-on line ========= */
  (function typeLine(){
    const el = document.getElementById('typeLine');
    const msg = "Let’s celebrate with love, balloons, cake, and a sky full of wishes. 💖🎈🎂";
    let i = 0, speed = 26;
    const tick = () => {
      if(i <= msg.length){ el.textContent = msg.slice(0, i++); requestAnimationFrame(()=>setTimeout(tick, speed)); }
    };
    tick();
  })();

  /* ========= Countdown (default target = next 8:00 PM local, override with ?t=ISO) ========= */
  (function countdown(){
    function parseTarget(){
      const q = new URLSearchParams(location.search).get('t');
      if(q){
        const dt = new Date(q);
        if(!Number.isNaN(dt.getTime())) return dt;
      }
      const now = new Date();
      const t = new Date(now);
      t.setHours(20,0,0,0); // 8:00 PM
      if(t <= now) t.setDate(t.getDate()+1);
      return t;
    }
    const target = parseTarget();
const d = document.getElementById('d'), h = document.getElementById('h'), m = document.getElementById('m'), s = document.getElementById('s');
    const note = document.getElementById('cdNote');
    note.textContent = "Counting down to: " + target.toLocaleString();

    function tick(){
      const now = new Date();
      let diff = Math.max(0, target - now);
      const secs = Math.floor(diff/1000);
      const days = Math.floor(secs/86400);
      const hours = Math.floor((secs%86400)/3600);
      const mins = Math.floor((secs%3600)/60);
      const sec = secs%60;
      d.textContent = days;
      h.textContent = String(hours).padStart(2,'0');
      m.textContent = String(mins).padStart(2,'0');
      s.textContent = String(sec).padStart(2,'0');
      if(diff === 0) return;
      requestAnimationFrame(()=>setTimeout(tick, 250));
    }
    tick();
  })();

  /* ========= Stream (pink hearts, red balloons, cakes) left -> right ========= */
  (function stream(){
    const layer = document.getElementById('stream');
    const RATE_MS = 800;        // spawn interval
    const MAX_NODES = 70;       // keep DOM light

    function make(type){
      const box = document.createElement('div');
      box.className = 'sail';

      // random tracks
      const y = (10 + Math.random()*70).toFixed(1) + 'vh';
      const bob = (Math.random()*14 - 7).toFixed(1) + 'vh';
      const dur = (14 + Math.random()*16).toFixed(1) + 's';
      const delay = (Math.random()*-20).toFixed(1) + 's';

      box.style.setProperty('--y', y);
      box.style.setProperty('--bob', bob);
      box.style.setProperty('--dur', dur);
      box.style.setProperty('--delay', delay);

      if(type === 'heart'){
        const h = document.createElement('div');
        h.className = 'heart';
        box.appendChild(h);
      }else if(type === 'balloon'){
        const b = document.createElement('div');
        b.className = 'redballoon';
        const s = document.createElement('div'); s.className = 'string';
        b.appendChild(s);
        box.appendChild(b);
      }else if(type === 'cake'){
        const c = document.createElement('div'); c.className = 'cake';
        c.innerHTML = '<div class="tier"></div><div class="candle"></div><div class="flame"></div>';
        box.appendChild(c);
      }

      layer.appendChild(box);
      // cleanup
      setTimeout(()=> box.remove(), 36000);
      // trim if too many
      const kids = layer.children;
      if(kids.length > MAX_NODES){
        for(let i=0; i<kids.length - MAX_NODES; i++) kids[i].remove();
      }
    }

    // initial burst
    for(let i=0;i<16;i++){
      make('heart'); make('balloon');
      if(i%4===0) make('cake');
    }

    setInterval(()=>{
      const r = Math.random();
      if(r < 0.5) make('heart');
      else if(r < 0.9) make('balloon');
      else make('cake');
    }, RATE_MS);
  })();

  /* ========= Floating wishes ========= */
  (function wishes(){
    const form = document.getElementById('wishForm');
    const input = document.getElementById('wishInput');
    const layer = document.getElementById('wishLayer');

    function addWish(text){
      if(!text.trim()) return;
      const b = document.createElement('div');
      b.className = 'wish-bubble';
      b.textContent = text.trim();

      // randomize path
      const left = (Math.random()*70 - 35).toFixed(1) + 'vw'; // -35vw..+35vw from center
      const dur = (9 + Math.random()*6).toFixed(1) + 's';
      const delay = (Math.random()*0.4).toFixed(1) + 's';
      b.style.setProperty('--x', left);
      b.style.setProperty('--dur', dur);
      b.style.setProperty('--delay', delay);

      layer.appendChild(b);
      setTimeout(()=> b.remove(), 14000);
    }

    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      const val = input.value.slice(0, 80);
      if(val){
        addWish(val);
        // mini confetti pop
        confetti.burst(innerWidth/2, innerHeight*.3, 70);
      }
      input.value = '';
      input.focus();
    });

    // seed a couple of demo wishes
setTimeout(()=>addWish("Happy birthday, Lee Wei Wen!"), 800);
    setTimeout(()=>addWish("Wishing you endless joy!"), 1600);
  })();

  /* ========= Confetti (exposed for wishes) ========= */
  const confetti = (function confettiSystem(){
    const cvs = document.getElementById('confetti');
    const ctx = cvs.getContext('2d');
    let W, H;
    function fit(){
      W = cvs.width = innerWidth * devicePixelRatio;
      H = cvs.height = innerHeight * devicePixelRatio;
      ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
    }
    addEventListener('resize', fit, {passive:true}); fit();

    const colors = ['#ff8ec6','#ffb6e0','#ffd1f0','#fff1f9','#f6d36a','#ffffff'];
    let pieces = [];
    function burst(x, y, count=180){
      for(let i=0;i<count;i++){
        const angle = Math.random()*Math.PI*2;
        const speed = 4 + Math.random()*6;
        pieces.push({
          x, y, vx: Math.cos(angle)*speed, vy: Math.sin(angle)*speed - 6,
          g: .18 + Math.random()*.08, w: 6 + Math.random()*6, h: 10 + Math.random()*10,
          rot: Math.random()*Math.PI, vr: (Math.random()-.5)*0.3, life: 120 + Math.random()*40,
          color: colors[Math.floor(Math.random()*colors.length)]
        });
      }
      if(!animId) animate();
    }

    let animId=null;
    function animate(){
      animId = requestAnimationFrame(animate);
      ctx.clearRect(0,0,innerWidth,innerHeight);
      for(let i=pieces.length-1; i>=0; i--){
        const p = pieces[i];
        p.vy += p.g; p.x += p.vx; p.y += p.vy; p.rot += p.vr; p.life -= 1;
        ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.rot);
        ctx.fillStyle = p.color; ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h); ctx.restore();
        if(p.y > innerHeight + 80 || p.life <= 0){ pieces.splice(i,1); }
      }
      if(pieces.length===0){ cancelAnimationFrame(animId); animId=null; }
    }

    // Public API
    return { burst };

  })();

  // Celebrate button & tap confetti
  (function party(){
    const partyBtn = document.getElementById('partyBtn');
    partyBtn.addEventListener('click', () => confetti.burst(innerWidth/2, innerHeight*.35));
    addEventListener('pointerdown', (e)=>{
      const tag = (e.target && e.target.tagName) ? e.target.tagName.toLowerCase() : '';
      if(tag === 'button' || e.target.closest('.wish-form')) return;
      confetti.burst(e.clientX, e.clientY, 90);
    });
  })();

  /* ========= Music ========= */
  (function music(){
    const btn = document.getElementById('musicBtn');
    const audio = document.getElementById('music');
    let playing = false;

    async function toggle(){
      try{
        if(!playing){
          await audio.play();
          playing = true; btn.textContent = '⏸️ Pause music';
        }else{
          audio.pause();
          playing = false; btn.textContent = '▶️ Play music';
        }
      }catch(e){
        alert('Add a file named “birthday.mp3” beside index.html, then tap Play again.');
      }
    }
    btn.addEventListener('click', toggle);
  })();

  /* ========= Share ========= */
  (function share(){
    const btn = document.getElementById('shareBtn');
    btn.addEventListener('click', async ()=>{
      const shareData = {
        title: document.title,
        text: "Come celebrate Lee Wei Wen’s birthday! 🎉",
        url: location.href
      };
      try{
        if(navigator.share){
          await navigator.share(shareData);
        }else{
          await navigator.clipboard.writeText(location.href);
          btn.textContent = '✅ Link copied!';
          setTimeout(()=>btn.textContent='🤝 Share', 1400);
        }
      }catch(e){ /* user canceled */ }
    });
  })();
  </script>
</body>
</html>
